"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[7040],{3905:(e,t,n)=>{n.d(t,{Zo:()=>h,kt:()=>p});var a=n(7294);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function i(e,t){if(null==e)return{};var n,a,o=function(e,t){if(null==e)return{};var n,a,o={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var l=a.createContext({}),c=function(e){var t=a.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):s(s({},t),e)),n},h=function(e){var t=c(e.components);return a.createElement(l.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},_=a.forwardRef((function(e,t){var n=e.components,o=e.mdxType,r=e.originalType,l=e.parentName,h=i(e,["components","mdxType","originalType","parentName"]),_=c(n),p=o,d=_["".concat(l,".").concat(p)]||_[p]||u[p]||r;return n?a.createElement(d,s(s({ref:t},h),{},{components:n})):a.createElement(d,s({ref:t},h))}));function p(e,t){var n=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var r=n.length,s=new Array(r);s[0]=_;var i={};for(var l in t)hasOwnProperty.call(t,l)&&(i[l]=t[l]);i.originalType=e,i.mdxType="string"==typeof e?e:o,s[1]=i;for(var c=2;c<r;c++)s[c]=n[c];return a.createElement.apply(null,s)}return a.createElement.apply(null,n)}_.displayName="MDXCreateElement"},7731:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>s,default:()=>u,frontMatter:()=>r,metadata:()=>i,toc:()=>c});var a=n(7462),o=(n(7294),n(3905));const r={},s="\ud83d\udcdd Create a Survey",i={unversionedId:"user-examples/survey",id:"user-examples/survey",title:"\ud83d\udcdd Create a Survey",description:"There are many cases where opinions or polls from the audience are needed. This section provides you with one approach using the Switch Tool.",source:"@site/docs/user-examples/01_survey.md",sourceDirName:"user-examples",slug:"/user-examples/survey",permalink:"/docs/user-examples/survey",draft:!1,tags:[],version:"current",sidebarPosition:1,frontMatter:{},sidebar:"defaultSidebar",previous:{title:"Advanced: Template Notebook",permalink:"/docs/project_notebook/template_notebook"},next:{title:"\ud83d\udcc8 House Data Visualization",permalink:"/docs/user-examples/house_data"}},l={},c=[{value:"<strong>1 Scenario</strong>",id:"1-scenario",level:2},{value:"<strong>2 Overall logic - How it works</strong>",id:"2-overall-logic---how-it-works",level:2},{value:"<strong>3 Template for the switches</strong>",id:"3-template-for-the-switches",level:2},{value:"3.1 Switches for all questions",id:"31-switches-for-all-questions",level:3},{value:"3.2 Define the bar chart",id:"32-define-the-bar-chart",level:3},{value:"<strong>4 Testing Zone</strong>",id:"4-testing-zone",level:2}],h={toc:c};function u(e){let{components:t,...n}=e;return(0,o.kt)("wrapper",(0,a.Z)({},h,n,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("h1",{id:"-create-a-survey"},"\ud83d\udcdd Create a Survey"),(0,o.kt)("p",null,"There are many cases where opinions or polls from the audience are needed. This section provides you with one approach using the Switch Tool."),(0,o.kt)("h2",{id:"1-scenario"},(0,o.kt)("strong",{parentName:"h2"},"1 Scenario")),(0,o.kt)("p",null,"You want to create a live survey about the mensa at the Leuphana. The audience is divided into 5 groups, each have a tablet. On each tablet, there is a slide containing following YES/NO questions:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Does the food served come from various cuisines?"),(0,o.kt)("li",{parentName:"ul"},"Are the food served priced reasonably?"),(0,o.kt)("li",{parentName:"ul"},"Are the food served nutritious enough?")),(0,o.kt)("p",null,"On the monitor, a bar chart displays the survey results (questions on X-axis, votes on Y-axis). This means, for this survey, you need to create 6 slides: 5 for the tablets, 1 for the monitor."),(0,o.kt)("h2",{id:"2-overall-logic---how-it-works"},(0,o.kt)("strong",{parentName:"h2"},"2 Overall logic - How it works")),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Since they are YES/NO questions, we opt for the Switch tool to record the answers."),(0,o.kt)("li",{parentName:"ul"},"For each of the question, you create ",(0,o.kt)("strong",{parentName:"li"},"one")," switch with ",(0,o.kt)("strong",{parentName:"li"},"one")," variable that contains any of/all votes from the tablets. This switch can later be placed on each of the tablet's slide, and is independent from the number of tablets you may have (you can have 10 groups and still only need one switch function for one question)."),(0,o.kt)("li",{parentName:"ul"},"All switches are off on initializing the tablets."),(0,o.kt)("li",{parentName:"ul"},"Each time a switch is flipped on (a group votes YES), the tally variable +=1."),(0,o.kt)("li",{parentName:"ul"},"Each time a switch is flipped back off (a group retracts their vote), the tally variable -=1."),(0,o.kt)("li",{parentName:"ul"},"Tally variables of all questions are fed into the chart, and the results are displayed dynamically on the big monitor.")),(0,o.kt)("h2",{id:"3-template-for-the-switches"},(0,o.kt)("strong",{parentName:"h2"},"3 Template for the switches")),(0,o.kt)("p",null,"Here I already wrote a function called ",(0,o.kt)("inlineCode",{parentName:"p"},"switch_template"),". As the name suggests, this serves as a template to create the ",(0,o.kt)("inlineCode",{parentName:"p"},"get_")," and ",(0,o.kt)("inlineCode",{parentName:"p"},"set_")," function pair, as well as the tally variable for any switch you might need. For example,\n",(0,o.kt)("inlineCode",{parentName:"p"},"def switch_template(switch_name='mensa', index=1)"),"\nwill create:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Function ",(0,o.kt)("inlineCode",{parentName:"li"},"get_switch_mensa_nr_1")),(0,o.kt)("li",{parentName:"ul"},"Function ",(0,o.kt)("inlineCode",{parentName:"li"},"get_switch_mensa_nr_1")),(0,o.kt)("li",{parentName:"ul"},"Tally variable ",(0,o.kt)("inlineCode",{parentName:"li"},"mensa_nr_1_total"))),(0,o.kt)("admonition",{title:"Python exkurs",type:"tip"},(0,o.kt)("p",{parentName:"admonition"},"Instead of naming the tally variable for each of the questions manually, we use ",(0,o.kt)("inlineCode",{parentName:"p"},"globals()")," to create a variable from a string. This way we can create loops and numbering our variables efficiently.")),(0,o.kt)("admonition",{title:"Disclaimer: Accidental browser refresh vs. incorrect survey results",type:"danger"},(0,o.kt)("p",{parentName:"admonition"},"Because of the connection between the backend (this notebook) and the frontend (the web browsers), there is currently no way to pinpoint which version of the switch is on which tablet. In other words, we only have this accumulated information of ",(0,o.kt)("em",{parentName:"p"},"how many votes are casted in total"),", not ",(0,o.kt)("em",{parentName:"p"},"which groups have casted the votes"),". This plays a crucial role in an error occurred during the beta phase, where a tablet browser from a group is accidentally refreshed during voting, which leads to a reset in the tally variable but not the state of the switch (e.x. switch still turned on but tally variable doesn't count the vote). Thus, if the group decides to turn off the switch, it cause the tally variable to incorrectly be subtracted, and in some cases leads to negative results. I prevented this with an ",(0,o.kt)("inlineCode",{parentName:"p"},"elif")," in the ",(0,o.kt)("inlineCode",{parentName:"p"},"set_switch")," function. If it happens that a browser is refreshed, a quick fix would be to tell all groups to turn all the switch off and vote again.")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-python"},"def switch_template(switch_name, index):\n    \"\"\"Create get and set switches for voting, based on the survey and the index of questions in that survey.\n    Result in all variables and functions with that number.\n    Example: running switch_sdg_template(1, 1) results in creating functions get_switch_m1_sdg_1(),\n    set_switch_m1_sdg_1()\n\n    Args:\n        switch_name (int): Name of the switch, muss related to the\n        number (int): SDG number\n    \"\"\"\n    globals()[f'{switch_name}_nr_{index}_total'] = 0\n\n    def get_switch(self):\n\n        # Here you can define the default state of the switch (when the page loads)\n        if globals()[f'{switch_name}_nr_{index}_total']:\n            return False\n        else:\n            return True\n\n    # Append the newly defined function to class tool_switch\n    setattr(tool_switch, f'get_switch_{switch_name}_nr_{index}', get_switch)\n\n    def set_switch(self, switch_state):\n        globals()[f'{switch_name}_nr_{index}_total']\n\n        # Here you decide what happens when the switch is flipped on / off\n        if switch_state:\n            globals()[f'{switch_name}_nr_{index}_total'] = globals()[f'{switch_name}_nr_{index}_total'] + 1\n        elif globals()[f'{switch_name}_nr_{index}_total'] > 0:\n            globals()[f'{switch_name}_nr_{index}_total'] = globals()[f'{switch_name}_nr_{index}_total'] - 1\n\n    # Append the newly defined function to class tool_switch\n    setattr(tool_switch,  f'set_switch_{switch_name}_nr_{index}', set_switch)\n")),(0,o.kt)("h3",{id:"31-switches-for-all-questions"},"3.1 Switches for all questions"),(0,o.kt)("p",null,'Warping it one more time in a loop allows us to "clone" the switch functions for however many questions we need in a survey. In our case, we need ',(0,o.kt)("inlineCode",{parentName:"p"},"create_switches(switch_name='mensa', amount=3)")),(0,o.kt)("p",null,"Again, the amount here refers to the number of the questions, not the number of the tablets/audience groups."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-python"},"def create_switches(switch_name, amount):\n\n    for i in range(1, amount + 1):\n        switch_template(switch_name, i)\n\ncreate_switches('mensa', 3)\n")),(0,o.kt)("h3",{id:"32-define-the-bar-chart"},"3.2 Define the bar chart"),(0,o.kt)("p",null,"The voting results are aggregated into the function ",(0,o.kt)("inlineCode",{parentName:"p"},"get_mensa_chart"),". Here, you are freely to design how the result chart looks like."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-python"},"def get_mensa_chart(self):\n    my_chart = MoloeweChart()\n\n    switch_name = 'mensa'\n    amount = 3\n\n    # Create dataframe from all questions\n    vote = [globals()[f'{switch_name}_nr_{index}_total'] for index in range(1, amount + 1)]\n    text = ['Various Cuisines', 'Reasonable Prices', 'Nutritrous']\n    df_vote = pd.DataFrame.from_dict({'text': text, 'vote': vote})\n\n    # Bar plot\n    f = px.bar(df_vote, x = f'text', y = \"vote\",\n                template=\"plotly_white\")\n\n    f.update_yaxes(range=[0,5], showticklabels=True)\n    f.update_xaxes(showticklabels=True)\n\n    f. update_layout(\n        xaxis_title=\"Questions\",\n        yaxis_title=\"Votes\",\n        title='Survey on Leuphana\\'s Mensa'\n    )\n\n    return my_chart.moloewe_chart_plot(plotly_data=f.to_dict(), plotly_config=dict())\n\nsetattr(tool_graph, \"get_mensa_chart\", get_mensa_chart)\n")),(0,o.kt)("h2",{id:"4-testing-zone"},(0,o.kt)("strong",{parentName:"h2"},"4 Testing Zone")),(0,o.kt)("p",null,"Here you can test run your code using the block below to generate the survey chart."),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"NOTE"),": This part MUST be commented out when you upload the notebook onto server."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-python"},"# Initialize code\n\nfrom moloewe_chart import MoloeweChart\n\ndef initialize_local_testing(local_data_path):\n    project_data = {\n        'folder_project_data': local_data_path + '/data/',\n        'folder_project_image': local_data_path + '/image/',\n        'folder_project_text': local_data_path + '/text/',\n        'folder_project_video': local_data_path + '/video/',\n        'folder_project_output': local_data_path + '/output/'\n    }\n    return project_data\n\n\n# Load local path (create all 5 asset folders within this path and put files in \"data\")\nlocal_path = r'D:/codes/sustil' # Give your own path\n\nproject_data = initialize_local_testing(local_path)\n\n# Initialize Moloewe() instance\nlocal_testing = Moloewe().project_initialize(project_data)\n\n# Initialize all testing objects\nplot_test = MoloeweChart()\ntool_map_test = tool_map()\ntool_graph_test = tool_graph()\ntool_switch_test = tool_switch()\ntool_dropdown_test = tool_dropdown()\ntool_slider_test = tool_slider()\n\n# Initialize the three question switches\n\ntool_switch_test.get_switch_mensa_nr_1()\ntool_switch_test.get_switch_mensa_nr_2()\ntool_switch_test.get_switch_mensa_nr_3()\n\n# Try switching on and off\n# This following scenario means 2 groups chose Q1, 3 groups chose Q2 and 5 groups chose Q3\n\ntool_switch_test.set_switch_mensa_nr_1(True)\ntool_switch_test.set_switch_mensa_nr_1(True)\n\ntool_switch_test.set_switch_mensa_nr_3(True)\ntool_switch_test.set_switch_mensa_nr_3(True)\ntool_switch_test.set_switch_mensa_nr_3(True)\n\ntool_switch_test.set_switch_mensa_nr_3(True)\ntool_switch_test.set_switch_mensa_nr_3(True)\ntool_switch_test.set_switch_mensa_nr_3(True)\ntool_switch_test.set_switch_mensa_nr_3(True)\ntool_switch_test.set_switch_mensa_nr_3(True)\n\n# Check the survey chart\n\nplot_test.moloewe_plot_preview(tool_graph_test.get_mensa_chart())\n\n# Now one group decided to retract their vote to question 3\n\ntool_switch_test.set_switch_mensa_nr_3(False)\n\n# Check the survey chart again\n\nplot_test.moloewe_plot_preview(tool_graph_test.get_mensa_chart())\n")))}u.isMDXComponent=!0}}]);