"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[2738],{3905:(e,t,a)=>{a.d(t,{Zo:()=>d,kt:()=>g});var n=a(7294);function l(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function r(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function o(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?r(Object(a),!0).forEach((function(t){l(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):r(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function i(e,t){if(null==e)return{};var a,n,l=function(e,t){if(null==e)return{};var a,n,l={},r=Object.keys(e);for(n=0;n<r.length;n++)a=r[n],t.indexOf(a)>=0||(l[a]=e[a]);return l}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(n=0;n<r.length;n++)a=r[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(l[a]=e[a])}return l}var s=n.createContext({}),p=function(e){var t=n.useContext(s),a=t;return e&&(a="function"==typeof e?e(t):o(o({},t),e)),a},d=function(e){var t=p(e.components);return n.createElement(s.Provider,{value:t},e.children)},m={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},u=n.forwardRef((function(e,t){var a=e.components,l=e.mdxType,r=e.originalType,s=e.parentName,d=i(e,["components","mdxType","originalType","parentName"]),u=p(a),g=l,c=u["".concat(s,".").concat(g)]||u[g]||m[g]||r;return a?n.createElement(c,o(o({ref:t},d),{},{components:a})):n.createElement(c,o({ref:t},d))}));function g(e,t){var a=arguments,l=t&&t.mdxType;if("string"==typeof e||l){var r=a.length,o=new Array(r);o[0]=u;var i={};for(var s in t)hasOwnProperty.call(t,s)&&(i[s]=t[s]);i.originalType=e,i.mdxType="string"==typeof e?e:l,o[1]=i;for(var p=2;p<r;p++)o[p]=a[p];return n.createElement.apply(null,o)}return n.createElement.apply(null,a)}u.displayName="MDXCreateElement"},6554:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>s,contentTitle:()=>o,default:()=>m,frontMatter:()=>r,metadata:()=>i,toc:()=>p});var n=a(7462),l=(a(7294),a(3905));const r={},o="\ud83d\uddfa\ufe0f Maps",i={unversionedId:"user-examples/maps",id:"user-examples/maps",title:"\ud83d\uddfa\ufe0f Maps",description:"1 Required Skills & Software",source:"@site/docs/05-user-examples/03_maps.md",sourceDirName:"05-user-examples",slug:"/user-examples/maps",permalink:"/docs/user-examples/maps",draft:!1,tags:[],version:"current",sidebarPosition:3,frontMatter:{},sidebar:"defaultSidebar",previous:{title:"\ud83d\udcc8 House Data Visualization",permalink:"/docs/user-examples/house_data"},next:{title:"Glossary",permalink:"/docs/glossary"}},s={},p=[{value:"<strong>1 Required Skills &amp; Software</strong>",id:"1-required-skills--software",level:2},{value:"<strong>2 How to start</strong>",id:"2-how-to-start",level:2},{value:"<strong>3 Mapbox</strong>",id:"3-mapbox",level:2},{value:"3.1 Using Mapbox",id:"31-using-mapbox",level:3},{value:"Pros",id:"pros",level:4},{value:"Cons",id:"cons",level:4},{value:"3.2 Scatter Plot",id:"32-scatter-plot",level:3},{value:"Example",id:"example",level:4},{value:"Source Data (Sample)",id:"source-data-sample",level:4},{value:"Python Code",id:"python-code",level:4},{value:"3.3 Scatter Plot with Dropdown List",id:"33-scatter-plot-with-dropdown-list",level:3},{value:"Example",id:"example-1",level:4},{value:"Source Data (Sample)",id:"source-data-sample-1",level:4},{value:"Python Code",id:"python-code-1",level:4},{value:"3.4 Choropleth Map - Continuous Color Scale",id:"34-choropleth-map---continuous-color-scale",level:3},{value:"Example",id:"example-2",level:4},{value:"Source Data (Sample)",id:"source-data-sample-2",level:4},{value:"Python Code",id:"python-code-2",level:4},{value:"3.5 Choropleth Map - Discrete Color Scale",id:"35-choropleth-map---discrete-color-scale",level:3},{value:"Example",id:"example-3",level:4},{value:"Source Data (Sample)",id:"source-data-sample-3",level:4},{value:"Python Code",id:"python-code-3",level:4},{value:"3.6 Choropleth Map - Discrete Color Scale with Slider and Barchart",id:"36-choropleth-map---discrete-color-scale-with-slider-and-barchart",level:3},{value:"Example",id:"example-4",level:4},{value:"Source Data (Sample)",id:"source-data-sample-4",level:4},{value:"Python Code",id:"python-code-4",level:4},{value:"3.7 Generating New Polygons",id:"37-generating-new-polygons",level:3},{value:"Example",id:"example-5",level:4},{value:"Source Data (Sample)",id:"source-data-sample-5",level:4},{value:"Python Code",id:"python-code-5",level:4},{value:"<strong>4 Creating Map/s Locally</strong>",id:"4-creating-maps-locally",level:2},{value:"4.1 Load Map/s from MoL\xf6we-Server",id:"41-load-maps-from-mol\xf6we-server",level:3},{value:"4.2 Load Map/s from Git-Repo",id:"42-load-maps-from-git-repo",level:3}],d={toc:p};function m(e){let{components:t,...r}=e;return(0,l.kt)("wrapper",(0,n.Z)({},d,r,{components:t,mdxType:"MDXLayout"}),(0,l.kt)("h1",{id:"\ufe0f-maps"},"\ud83d\uddfa\ufe0f Maps"),(0,l.kt)("h2",{id:"1-required-skills--software"},(0,l.kt)("strong",{parentName:"h2"},"1 Required Skills & Software")),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"GIS"),(0,l.kt)("li",{parentName:"ul"},"Python"),(0,l.kt)("li",{parentName:"ul"},"Gitlab")),(0,l.kt)("h2",{id:"2-how-to-start"},(0,l.kt)("strong",{parentName:"h2"},"2 How to start")),(0,l.kt)("p",null,"There are two ways to incorporate a map in MoL\xf6we: ",(0,l.kt)("a",{parentName:"p",href:"https://miro.com/app/board/uXjVPfd4oZ8=/?share_link_id=811493081374"},(0,l.kt)("strong",{parentName:"a"},"Here's a simple flowchart"))),(0,l.kt)("p",null,"If your gis file (e.g. shapefile) is\u2026"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("strong",{parentName:"li"},"smaller")," than 45 Mb: use Mapbox"),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("strong",{parentName:"li"},"bigger")," than 45 Mb: create a map locally in a GIS and load it as an image file (either from the MoL\xf6we-Server or from Git-repo) into MoL\xf6we")),(0,l.kt)("p",null,"In the following, the two ways are presented in detail. Example maps, their data and python codes are given. The examples are intended to give you a glimpse into what\u2019s possible with maps in the MoL\xf6we."),(0,l.kt)("hr",null),(0,l.kt)("admonition",{title:"Before you start",type:"tip"},(0,l.kt)("p",{parentName:"admonition"},"You can copy/paste the given python codes in your notebook and adjust them to your needs. However, you must import the following modules in your notebook first:"),(0,l.kt)("pre",{parentName:"admonition"},(0,l.kt)("code",{parentName:"pre",className:"language-python"},"import pandas as pd\nimport geopandas as gpd\n\nimport plotly.express as px\nimport plotly.graph_objects as go\n")),(0,l.kt)("p",{parentName:"admonition"},"Also, you need to define a mapbox token at the beginning of your notebook, such as:"),(0,l.kt)("pre",{parentName:"admonition"},(0,l.kt)("code",{parentName:"pre",className:"language-python"},'mapbox_access_token = "pk.eyJ1IjoibW9sb2V3ZSIsImEiOiJjanprMzFkODUwMnJyM29vM3lwYWNwMG5jIn0.ElIGswv7z_KNHyivxm9yrg"\n'))),(0,l.kt)("h2",{id:"3-mapbox"},(0,l.kt)("strong",{parentName:"h2"},"3 Mapbox")),(0,l.kt)("h3",{id:"31-using-mapbox"},"3.1 Using Mapbox"),(0,l.kt)("p",null,"All GIS processing and plotting is happening \u201cfrom scratch\u201d each time you access the slide (using the files imported to the MoL\xf6we-Server for the project)."),(0,l.kt)("h4",{id:"pros"},"Pros"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"interactivity: you can freely zoom, navigate and turn off elements in the map"),(0,l.kt)("li",{parentName:"ul"},"hovertext"),(0,l.kt)("li",{parentName:"ul"},"wide range of basemaps to ease orientation")),(0,l.kt)("h4",{id:"cons"},"Cons"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"difficulties loading larger (?mb) file sizes"),(0,l.kt)("li",{parentName:"ul"},"plotting time depends on amount of data points: plotting large amount of data points will take a while")),(0,l.kt)("hr",null),(0,l.kt)("admonition",{title:"Before you start",type:"tip"},(0,l.kt)("p",{parentName:"admonition"},"In order to use shape files in your maps, you must import the shape files with all of their extensions to the MoL\xf6we-Server. Supported formats on the Server are .shp, .shx, .prj and .dbf (cpg-files are not supported).")),(0,l.kt)("h3",{id:"32-scatter-plot"},"3.2 Scatter Plot"),(0,l.kt)("p",null,"Mapbox Scatter plots can be built from either a coordinate table (long & lat) or from a point shape file."),(0,l.kt)("h4",{id:"example"},"Example"),(0,l.kt)("p",null,"Each dot is a tree, the color representing its health aka. its \u201cscore\u201d. Hovering over a tree will show its coordinates and description of health (\u201dexcellent\u201d, \u201cgood\u201d or \u201cunfit\u201d). The source data is a point shapefile previously uploaded to the MoL\xf6we-Server (using a coordinate table would also be possible, see python code below)."),(0,l.kt)("p",null,(0,l.kt)("img",{src:a(1830).Z,width:"600",height:"302"})),(0,l.kt)("h4",{id:"source-data-sample"},"Source Data (Sample)"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"lat"),(0,l.kt)("th",{parentName:"tr",align:null},"lon"),(0,l.kt)("th",{parentName:"tr",align:null},"text"),(0,l.kt)("th",{parentName:"tr",align:null},"score"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"53.2645"),(0,l.kt)("td",{parentName:"tr",align:null},"10.3985"),(0,l.kt)("td",{parentName:"tr",align:null},"excellent"),(0,l.kt)("td",{parentName:"tr",align:null},"1")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"53.2646"),(0,l.kt)("td",{parentName:"tr",align:null},"103.985"),(0,l.kt)("td",{parentName:"tr",align:null},"excellent"),(0,l.kt)("td",{parentName:"tr",align:null},"1")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"53.2634"),(0,l.kt)("td",{parentName:"tr",align:null},"10.3981"),(0,l.kt)("td",{parentName:"tr",align:null},"good"),(0,l.kt)("td",{parentName:"tr",align:null},"2")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"53.2647"),(0,l.kt)("td",{parentName:"tr",align:null},"10.3981"),(0,l.kt)("td",{parentName:"tr",align:null},"unfit"),(0,l.kt)("td",{parentName:"tr",align:null},"4")))),(0,l.kt)("h4",{id:"python-code"},"Python Code"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-python"},'def get_tree_map(self):\n\n  # load point shapefile (from the MoL\xf6we-Server) as geodataframe\n  trees = gpd.read_file(data + "trees.shp")\n  # Note: The EPSG of the example data is 4326\n\n  # The EPSG of your data must be 4326 to work in mapbox. If it\'s not, you could re-project it:\n  # trees = trees.to_crs(epsg=4326)\n  # Since the EPSG of the example data is already in 4326, we don\'t need to re-project it\n  \n  # You can also generate a geodataframe from a coordinate table:\n  # trees = pd.read_csv(text + "trees.txt", sep=";")\n  # trees = gpd.GeoDataFrame(trees, crs="EPSG:4326", geometry=gpd.points_from_xy(trees.lon, trees.lat))\n  # Note: The second argument is the EPSG of the data. If it\'s not already 4326, you must re-project it (see above)\n\n  \n  # plot\n  fig = px.scatter_mapbox(data_frame=trees,\n                          lat="lat",\n                          lon="lon",\n                          color="score",\n                          opacity=0.7,\n                          color_continuous_scale="temps",\n                          mapbox_style="carto-positron",\n                          zoom=14,\n                          center={"lat": 53.268039, "lon": 10.403832})\n  \n  # set a fixed marker size\n  fig.update_traces(marker={\'size\': 38})\n\n  my_config = dict()\n\n  return my_chart.moloewe_chart_plot(plotly_data = fig.to_dict(), plotly_config = my_config)\n        \nsetattr(tool_map, "get_treemap", get_treemap)\n')),(0,l.kt)("h3",{id:"33-scatter-plot-with-dropdown-list"},"3.3 Scatter Plot with Dropdown List"),(0,l.kt)("h4",{id:"example-1"},"Example"),(0,l.kt)("p",null,"Same as in previous example, however, now we can restrict the map to trees that belong to a certain health category (\u201dexcellent\u201d, \u201cgood\u201d or \u201cunfit\u201d) using a dropdown list. Hovering over a tree will show its coordinates and score."),(0,l.kt)("p",null,"Note: After making a selection in the dropdown list, the map must be refreshed (in the upper right corner of the map) to apply the changes."),(0,l.kt)("p",null,(0,l.kt)("img",{src:a(7136).Z,width:"600",height:"274"})),(0,l.kt)("h4",{id:"source-data-sample-1"},"Source Data (Sample)"),(0,l.kt)("p",null,"(same as in previous example)"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"lat"),(0,l.kt)("th",{parentName:"tr",align:null},"lon"),(0,l.kt)("th",{parentName:"tr",align:null},"text"),(0,l.kt)("th",{parentName:"tr",align:null},"score"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"53.2645"),(0,l.kt)("td",{parentName:"tr",align:null},"10.3985"),(0,l.kt)("td",{parentName:"tr",align:null},"excellent"),(0,l.kt)("td",{parentName:"tr",align:null},"1")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"53.2646"),(0,l.kt)("td",{parentName:"tr",align:null},"103.985"),(0,l.kt)("td",{parentName:"tr",align:null},"excellent"),(0,l.kt)("td",{parentName:"tr",align:null},"1")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"53.2634"),(0,l.kt)("td",{parentName:"tr",align:null},"10.3981"),(0,l.kt)("td",{parentName:"tr",align:null},"good"),(0,l.kt)("td",{parentName:"tr",align:null},"2")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"53.2647"),(0,l.kt)("td",{parentName:"tr",align:null},"10.3981"),(0,l.kt)("td",{parentName:"tr",align:null},"unfit"),(0,l.kt)("td",{parentName:"tr",align:null},"4")))),(0,l.kt)("h4",{id:"python-code-1"},"Python Code"),(0,l.kt)("p",null,(0,l.kt)("strong",{parentName:"p"},"Dropdown List Functions")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-python"},'# define default dropdown selection\ntrees_health = "excellent"\n\n\ndef get_tree_dropdown(self):\n    return {\n        "values": ["excellent", "good", "unfit"],\n        "default": trees_health,\n    }\n\nsetattr(tool_dropdown, "get_tree_dropdown", get_tree_dropdown)\n\n\ndef set_tree_dropdown(self, dropdown_selection):\n    global trees_health\n    trees_health = dropdown_selection\n\nsetattr(tool_dropdown, "set_tree_dropdown", set_tree_dropdown)\n')),(0,l.kt)("p",null,(0,l.kt)("strong",{parentName:"p"},"Map Function")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-python"},'def get_tree_dropdown_map(self):\n\n  # Note:\n  # - This is mostly the same code as for the first scatter plot example, \n  #   the only difference here is that we first select the trees that fall\n  #   into the selected health category\n  # - also, the hovertext will now show the score\n  \n  # load point shapefile (from the MoL\xf6we-Server) as geodataframe\n  trees = gpd.read_file(data + "trees.shp")\n  # Note: The EPSG of the example data is 4326\n\n  # The EPSG of your data must be 4326 to work in mapbox. If it\'s not, you could re-project it:\n  # trees = trees.to_crs(epsg=4326)\n  # Since the EPSG of the example data is already in 4326, we don\'t need to re-project it\n  \n  # You can also generate a geodataframe from a coordinate table:\n  # trees = pd.read_csv(text + "trees.txt", sep=";")\n  # trees = gpd.GeoDataFrame(trees, crs="EPSG:4326", geometry=gpd.points_from_xy(trees.lon, trees.lat))\n  # Note: The second argument is the EPSG of the data. If it\'s not already 4326, you must re-project it (see above)\n  \n  # select the trees that fall into the selected health category\n  trees = trees[trees["text"] == trees_health]\n  \n  # plot\n  fig = px.scatter_mapbox(data_frame=trees,\n                          lat="lat",\n                          lon="lon",\n                          color="score",\n                          opacity=0.7,\n                          color_continuous_scale="temps",\n                          mapbox_style="carto-positron",\n                          zoom=14,\n                          center={"lat": 53.268039, "lon": 10.403832})\n  \n  # set a fixed marker size\n  fig.update_traces(marker={\'size\': 38})\n\n  my_config = dict()\n\n  return my_chart.moloewe_chart_plot(plotly_data = fig.to_dict(), plotly_config = my_config)\n        \nsetattr(tool_map, "get_tree_dropdown_map", get_tree_dropdown_map)\n')),(0,l.kt)("h3",{id:"34-choropleth-map---continuous-color-scale"},"3.4 Choropleth Map - Continuous Color Scale"),(0,l.kt)("h4",{id:"example-2"},"Example"),(0,l.kt)("p",null,"Buildings are colored according to their height. The source data is a shape file (imported to the MoL\xf6we-Server). Hovering over a building will show its index in the shape file and its height (\u201dHOEHEGEB\u201d). A continuous color scale is used."),(0,l.kt)("p",null,(0,l.kt)("img",{src:a(6854).Z,width:"600",height:"246"})),(0,l.kt)("h4",{id:"source-data-sample-2"},"Source Data (Sample)"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},'"HOEHEGEB": Building heights'),(0,l.kt)("li",{parentName:"ul"},'"DACHFORM": Roof shapes (not relevant in this example)')),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"HOEHEGEB"),(0,l.kt)("th",{parentName:"tr",align:null},"DACHFORM"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"14.2"),(0,l.kt)("td",{parentName:"tr",align:null},"flat")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"12.0"),(0,l.kt)("td",{parentName:"tr",align:null},"gable")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"34.2"),(0,l.kt)("td",{parentName:"tr",align:null},"gable")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"18.6"),(0,l.kt)("td",{parentName:"tr",align:null},"shed")))),(0,l.kt)("h4",{id:"python-code-2"},"Python Code"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-python"},'def get_buildings_continuous_map(self):\n\n  # load shapefile (from the MoL\xf6we-Server) as geodataframe\n  buildings = gpd.read_file(data + "buildings.shp")\n  # Note: The EPSG of the example data is 25832\n\n  # re-project to EPSG 4326 (for mapbox)\n  buildings = buildings.to_crs(epsg=4326)\n\n  # plot\n  fig = px.choropleth_mapbox(data_frame=buildings,\n                              geojson=buildings.geometry,\n                              locations=buildings.index,\n                              mapbox_style="carto-positron",\n                              color="HOEHEGEB",\n                              color_continuous_scale="OrRd",\n                              zoom=15,\n                              center={"lat": 53.250, "lon": 10.411})\n\n  my_config = dict()\n\n  return my_chart.moloewe_chart_plot(plotly_data = fig.to_dict(), plotly_config = my_config)\n        \nsetattr(tool_map, "get_buildings_continuous_map", get_buildings_continuous_map)\n')),(0,l.kt)("h3",{id:"35-choropleth-map---discrete-color-scale"},"3.5 Choropleth Map - Discrete Color Scale"),(0,l.kt)("h4",{id:"example-3"},"Example"),(0,l.kt)("p",null,"Same as in previous example, however, now the buildings are colored according to their roof shape (\u201dflat\u201d, \u201cgable\u201d, \u201cshed\u201d) using a  discreet (i.e. categorical) color scale."),(0,l.kt)("p",null,(0,l.kt)("img",{src:a(8103).Z,width:"600",height:"243"})),(0,l.kt)("h4",{id:"source-data-sample-3"},"Source Data (Sample)"),(0,l.kt)("p",null,"(same as in previous example)"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"HOEHEGEB"),(0,l.kt)("th",{parentName:"tr",align:null},"DACHFORM"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"14.2"),(0,l.kt)("td",{parentName:"tr",align:null},"flat")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"12.0"),(0,l.kt)("td",{parentName:"tr",align:null},"gable")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"34.2"),(0,l.kt)("td",{parentName:"tr",align:null},"gable")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"18.6"),(0,l.kt)("td",{parentName:"tr",align:null},"shed")))),(0,l.kt)("h4",{id:"python-code-3"},"Python Code"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-python"},'def get_buildings_discreet_map(self):\n\n  # load shapefile (from the MoL\xf6we-Server) as geodataframe\n  buildings = gpd.read_file(data + "buildings.shp")\n  # Note: The EPSG of the example data is 25832\n\n  # re-project to EPSG 4326 (for mapbox)\n  buildings = buildings.to_crs(epsg=4326)\n  \n  colors = {"gable": "blue",\n            "shed": "green",\n            "flat": "yellow"}\n\n  # plot\n  fig = px.choropleth_mapbox(data_frame=buildings,\n                              geojson=buildings.geometry,\n                              locations=buildings.index,\n                              mapbox_style="carto-positron",\n                              color="DACHFORM",\n                              color_discrete_map=colors,\n                              zoom=15,\n                              center={"lat": 53.250, "lon": 10.411})\n\n  my_config = dict()\n\n  return my_chart.moloewe_chart_plot(plotly_data = fig.to_dict(), plotly_config = my_config)\n        \nsetattr(tool_map, "get_buildings_discreet_map", get_buildings_discreet_map)\n')),(0,l.kt)("h3",{id:"36-choropleth-map---discrete-color-scale-with-slider-and-barchart"},"3.6 Choropleth Map - Discrete Color Scale with Slider and Barchart"),(0,l.kt)("h4",{id:"example-4"},"Example"),(0,l.kt)("p",null,"Same as in previous example, however, now we have a slider where we choose a height threshold. Buildings whose heights fall below this threshold are removed from the map. In addition, a bar chart next to the map shows the amount of remaining buildings grouped by roof shape."),(0,l.kt)("p",null,"Note: After selecting a new value on the slider, the map must be refreshed (in the upper right corner of the map) to apply the changes. The same goes for the bar chart."),(0,l.kt)("p",null,(0,l.kt)("img",{src:a(2273).Z,width:"600",height:"259"})),(0,l.kt)("h4",{id:"source-data-sample-4"},"Source Data (Sample)"),(0,l.kt)("p",null,"(same as in previous example)"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"HOEHEGEB"),(0,l.kt)("th",{parentName:"tr",align:null},"DACHFORM"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"14.2"),(0,l.kt)("td",{parentName:"tr",align:null},"flat")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"12.0"),(0,l.kt)("td",{parentName:"tr",align:null},"gable")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"34.2"),(0,l.kt)("td",{parentName:"tr",align:null},"gable")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"18.6"),(0,l.kt)("td",{parentName:"tr",align:null},"shed")))),(0,l.kt)("h4",{id:"python-code-4"},"Python Code"),(0,l.kt)("p",null,(0,l.kt)("strong",{parentName:"p"},"Slider Functions")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-python"},'# define default slider value\nbuildings_height = 0\n\ndef get_buildings_height(self):\n  return {\n      "Minimum": 0,\n      "Maximum": 35,\n      "Step": 1,\n      "Default": buildings_height,\n  }\n\nsetattr(tool_slider, "get_buildings_height", get_buildings_height)\n\ndef set_buildings_height(self, slider_selection):\n  global buildings_height\n  buildings_height = float(slider_selection)\n    \nsetattr(tool_slider, "set_buildings_height", set_buildings_height)\n')),(0,l.kt)("p",null,(0,l.kt)("strong",{parentName:"p"},"Map Function")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-python"},'def get_buildings_slider_map(self):\n\n  # load shapefile (from the MoL\xf6we-Server) as geodataframe\n  buildings = gpd.read_file(data + "buildings.shp")\n  # Note: The EPSG of the example data is 25832\n\n  # re-project to EPSG 4326 (for mapbox)\n  buildings = buildings.to_crs(epsg=4326)\n  \n  # select buildings whose height is above the selected threshold\n  buildings_subset = buildings[buildings["HOEHEGEB"] > buildings_height]\n  \n  colors = {"gable": "blue",\n            "shed": "green",\n            "flat": "yellow"}\n\n  # plot\n  fig = px.choropleth_mapbox(data_frame=buildings_subset,\n                              geojson=buildings_subset.geometry,\n                              locations=buildings_subset.index,\n                              mapbox_style="carto-positron",\n                              color="DACHFORM",\n                              color_discrete_map=colors,\n                              zoom=15,\n                              center={"lat": 53.250, "lon": 10.411})\n\n  my_config = dict()\n\n  return my_chart.moloewe_chart_plot(plotly_data = fig.to_dict(), plotly_config = my_config)\n        \nsetattr(tool_map, "get_buildings_slider_map", get_buildings_slider_map)\n')),(0,l.kt)("p",null,(0,l.kt)("strong",{parentName:"p"},"Bar Chart Function")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-python"},'def get_buildings_slider_barchart(self):\n\n  # load shapefile (from the MoL\xf6we-Server) as geodataframe\n  buildings = gpd.read_file(data + "buildings.shp")\n  \n  # filter out buildings\n  buildings_subset = buildings[buildings["HOEHEGEB"] > buildings_height]\n  \n  colors = {"gable": "blue",\n            "shed": "green",\n            "flat": "yellow"}\n\n  # group building subset by roof shape and get count of each group\n  df = buildings_subset.groupby(\'DACHFORM\').size().reset_index(name=\'building_count\')\n  \n  fig = px.bar(df,\n                x=\'DACHFORM\',\n                y=\'building_count\',\n                color="DACHFORM",\n                color_discrete_map=colors)\n\n  my_config = dict()\n\n  return my_chart.moloewe_chart_plot(plotly_data = fig.to_dict(), plotly_config = my_config)\n        \nsetattr(tool_graph, "get_buildings_slider_barchart", get_buildings_slider_barchart)\n')),(0,l.kt)("h3",{id:"37-generating-new-polygons"},"3.7 Generating New Polygons"),(0,l.kt)("h4",{id:"example-5"},"Example"),(0,l.kt)("p",null,"So far, we generated our polygons beforehand (i.e. in a GIS) and imported them into the MoL\xf6we-Server to use them in Mapbox. We can also generate new polygons within Mapbox."),(0,l.kt)("p",null,"In this example we are generating buffers around trees. The buffer size is defined by the slider input. Each time a new value is selected on the slider, new buffers are generated and then displayed in the map."),(0,l.kt)("p",null,"Note: After selecting a new value on the slider, the map must be refreshed (in the upper right corner of the map) to apply the changes. "),(0,l.kt)("p",null,(0,l.kt)("img",{src:a(2700).Z,width:"600",height:"250"})),(0,l.kt)("h4",{id:"source-data-sample-5"},"Source Data (Sample)"),(0,l.kt)("p",null,"(same as example \u201cScatter Plot\u201d)"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"lat"),(0,l.kt)("th",{parentName:"tr",align:null},"lon"),(0,l.kt)("th",{parentName:"tr",align:null},"text"),(0,l.kt)("th",{parentName:"tr",align:null},"score"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"53.2645"),(0,l.kt)("td",{parentName:"tr",align:null},"10.3985"),(0,l.kt)("td",{parentName:"tr",align:null},"excellent"),(0,l.kt)("td",{parentName:"tr",align:null},"1")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"53.2646"),(0,l.kt)("td",{parentName:"tr",align:null},"103.985"),(0,l.kt)("td",{parentName:"tr",align:null},"excellent"),(0,l.kt)("td",{parentName:"tr",align:null},"1")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"53.2634"),(0,l.kt)("td",{parentName:"tr",align:null},"10.3981"),(0,l.kt)("td",{parentName:"tr",align:null},"good"),(0,l.kt)("td",{parentName:"tr",align:null},"2")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"53.2647"),(0,l.kt)("td",{parentName:"tr",align:null},"10.3981"),(0,l.kt)("td",{parentName:"tr",align:null},"unfit"),(0,l.kt)("td",{parentName:"tr",align:null},"4")))),(0,l.kt)("h4",{id:"python-code-5"},"Python Code"),(0,l.kt)("p",null,(0,l.kt)("strong",{parentName:"p"},"Slider Functions")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-python"},'# define default slider value\ntrees_buffer = 0\n\ndef get_tree_buffer(self):\n  return {\n      "Minimum": 0,\n      "Maximum": 50,\n      "Step": 1,\n      "Default": trees_buffer,\n  }\n\nsetattr(tool_slider, "get_tree_buffer", get_tree_buffer)\n\ndef set_tree_buffer(self, slider_selection):\n  global trees_buffer\n  trees_buffer = float(slider_selection)\n    \nsetattr(tool_slider, "set_tree_buffer", set_tree_buffer)\n')),(0,l.kt)("p",null,(0,l.kt)("strong",{parentName:"p"},"Map Function")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-python"},'def get_trees_buffer_map(self):\n    \n  # load point shapefile (from the MoL\xf6we-Server) as geodataframe\n  trees = gpd.read_file(data + "trees.shp")\n  # Note: The EPSG of the example data is 4326\n\n  # create buffer\n  trees = trees.to_crs(epsg=25832) # we need to re-project "trees" to a projected CRS to get correct buffers\n  buff = gpd.GeoDataFrame(geometry=trees.buffer(trees_buffer))\n  buff["category"] = "buffer"\n  buff = buff.dissolve(by="category")\n  \n  # plot trees\n  trees = trees.to_crs(epsg=4326)\n  fig = px.scatter_mapbox(data_frame=trees,\n                          lat="lat",\n                          lon="lon",\n                          mapbox_style="carto-positron",\n                          zoom=14,\n                          center={"lat": 53.268039, "lon": 10.403832})\n  \n  # set fixed color for the trees:\n  fig.update_traces(marker={\'color\': "forestgreen"})\n  \n  # You can set a fixed marker size for the trees:\n  # fig.update_traces(marker={\'size\': 38})\n  \n  # plot buffer\n  buff = buff.to_crs(epsg=4326)\n  buff["category"] = "buffer"\n  fig_buff = px.choropleth_mapbox(data_frame=buff,\n                                  geojson=buff.geometry,\n                                  locations=buff.index,\n                                  color="category",\n                                  color_discrete_map={\'buffer\': \'green\'},\n                                  opacity=0.5)\n              \n  fig_buff.update_traces(marker_line_width=0)\n\n  # merge both plots into one\n  if trees_buffer > 0:\n      fig.add_trace(fig_buff.data[0])\n\n  my_config = dict()\n\n  return my_chart.moloewe_chart_plot(plotly_data = fig.to_dict(), plotly_config = my_config)\n        \nsetattr(tool_map, "get_trees_buffer_map", get_trees_buffer_map)\n')),(0,l.kt)("hr",null),(0,l.kt)("h2",{id:"4-creating-maps-locally"},(0,l.kt)("strong",{parentName:"h2"},"4 Creating Map/s Locally")),(0,l.kt)("p",null,(0,l.kt)("strong",{parentName:"p"},"Pros")),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"})),(0,l.kt)("p",null,(0,l.kt)("strong",{parentName:"p"},"Cons")),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"})),(0,l.kt)("p",null,(0,l.kt)("strong",{parentName:"p"},"Loading your Map/s into MoL\xf6we")),(0,l.kt)("p",null,(0,l.kt)("strong",{parentName:"p"},"Two Options:")),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"If you want to show only 1 map or switch between less than 5 Maps: ",(0,l.kt)("strong",{parentName:"li"},"Load Map/s from MoL\xf6we-Server")),(0,l.kt)("li",{parentName:"ul"},"If you have more than 5 maps that you want to switch between: ",(0,l.kt)("strong",{parentName:"li"},"Load Map from Git-Repo"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"the import on the MoL\xf6we-Server would be very time-consuming otherwise")))),(0,l.kt)("h3",{id:"41-load-maps-from-mol\xf6we-server"},"4.1 Load Map/s from MoL\xf6we-Server"),(0,l.kt)("h3",{id:"42-load-maps-from-git-repo"},"4.2 Load Map/s from Git-Repo"))}m.isMDXComponent=!0},6854:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/mapbox_choro_cotinuous_gif-063d8bcde950474006868c6c504b0136.gif"},8103:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/mapbox_choro_discreet_gif-a5d48bbe241f655f90fa04b1b454316b.gif"},2273:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/mapbox_choro_slider_piechart_gif-5edbcbedfa2e3951c47366873c887945.gif"},2700:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/mapbox_generate_polygons_gif-61290861c89136b47f1f75bca27685b1.gif"},7136:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/mapbox_scatter_dropdown_gif-27192d4939491ef5eee71d0acf93a376.gif"},1830:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/mapbox_scatter_gif-f546b72b845a7d45f8755fba51f6ba05.gif"}}]);